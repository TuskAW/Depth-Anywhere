<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Depth Anywhere: Enhancing 360 Monocular Depth Estimation via Perspective Distillation and Unlabeled Data Augmentation">
  <meta name="keywords" content="depth, estimation, monocular, scene, reconstruction, 360, distillation, perspective, panorama, equirectangular">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:image:src" content="">
  <meta name="twitter:title" content="Depth Anywhere">
  <meta name="twitter:description" content="Depth Anywhere: Enhancing 360 Monocular Depth Estimation via Perspective Distillation and Unlabeled Data Augmentation">
  <meta name="twitter:creator" content="@albert100121">

  <title>Depth Anywhere: Enhancing 360 Monocular Depth Estimation via Perspective Distillation and Unlabeled Data Augmentation</title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./css/bulma.min.css">
  <link rel="stylesheet" href="./css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./css/bulma-slider.min.css">
  <link rel="stylesheet" href="./css/twentytwenty.css">
  <link rel="stylesheet" href="./css/index.css">
  <!-- point cloud  -->
  <link rel="stylesheet" href="./css/style.css">
  <!-- point cloud  -->
  <link rel="icon" href="./images/favicon.svg">

  <script src="./js/jquery-3.2.1.min.js"></script>
  <script src="./js/jquery.event.move.js"></script>
  <script src="./js/jquery.twentytwenty.js"></script>
  <script src="./js/bulma-carousel.min.js"></script>
  <script src="./js/bulma-slider.min.js"></script>
  <script src="./js/fontawesome.all.min.js"></script>
  <!-- point cloud  -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="js/OrbitControls.js"></script>
  <script src="js/PCDLoader.js"></script>
  <script src="js/pcd.js"></script>
  <!-- point cloud  -->

  <!--MathJax-->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
  </script>
  <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Depth Anywhere: Enhancing 360 Monocular Depth Estimation via Perspective Distillation and Unlabeled Data Augmentation</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="http://albert100121.github.io/" target="_blank" rel="noopener noreferrer">
                Ning-Hsu Wang</a>,
            </span>
            <span class="author-block">
              <a href="https://yulunalexliu.github.io" target="_blank" rel="noopener noreferrer">
                Yu-Lun Liu<sup>1</sup></a>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block">
                <a href="https://www.nycu.edu.tw/nycu/en/index" target="_blank" rel="noopener noreferrer"><sup>1</sup>National Yang Ming Chiao Tung University</a>
            </span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <span class="link-block">
                <a href="" target="_blank" rel="noopener noreferrer"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf" style="color: orangered"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="" target="_blank" rel="noopener noreferrer"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>
                    Code (tbd)
                  </span>
                </a>
              </span>
              <!-- Hugging Face Space. -->
              <span class="link-block">
                <a href="https://huggingface.co/spaces/Albert-NHWang/Depth-Anywhere-App" target="_blank" rel="noopener noreferrer"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      &#129303;
                  </span>
                  <span>Interactive Demo</span>
                </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <img id="teaser" width="100%" src="./images/teaser/teaser_v7.jpg" alt="Teaser image demonstrating improvements on SOTA 360 model."/>
      <h2 class="subtitle has-text-centered">
        <span class="methodname">Depth Anywhere</span> distills the knowledge from SOTA perspective depth model and improves SOTA 360 depth models.
      </h2>
    </div>
  </div>
</section>


<section class="section pt-0">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Accurately estimating depth in 360-degree imagery is crucial for virtual reality, 
            autonomous navigation, and immersive media applications. 
            Existing depth estimation methods designed for perspective-view imagery fail when applied to 360-degree images due to different camera projections and distortions, 
            whereas 360-degree methods perform inferior due to the lack of labeled data pairs. 
            We propose a new depth estimation framework that utilizes unlabeled 360-degree data effectively. 
            Our approach uses state-of-the-art perspective depth estimation models as teacher models to generate pseudo labels through a six-face cube projection technique, 
            enabling efficient labeling of depth in 360-degree images. 
            This method leverages the increasing availability of large datasets. 
            Our approach includes two main stages: offline mask generation for invalid regions and an online semi-supervised joint training regime. 
            We tested our approach on benchmark datasets such as Matterport3D and Stanford2D3D, 
            showing significant improvements in depth estimation accuracy, 
            particularly in zero-shot scenarios. 
            Our proposed training pipeline can enhance any 360 monocular depth estimator and demonstrates effective knowledge transfer across different camera projections and data types.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->
  </div>
</section>

<section class="section pt-0 pb-4">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">In-domain Gallery</h2>
        <p>
            This is the in-domain qualitative improvements with backbone models (UniFuse and Bifuse++ are selected) trained on Matterport3D train set and test on test set.
            <br><strong>+Ours</strong> indicates using the pseudo ground truth training pipeline proposed in our methods.
        </p>
      </div>
    </div>
  </div>
</section>

<section class="hero is-light is-small mt-4">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel-horizontal" class="carousel results-carousel">

        <!-- UniFuse -->
        <div class="twoitem">
          <div class="twentytwenty-container twentytwenty-container-top">
            <div class="cmpcontent">
              <img src="./images/slider/in-domain-jpg/rgb1_unifuse.jpg">
            </div>
            <div class="cmpcontent">
              <img src="./images/slider/in-domain-jpg/gt1_unifuse.jpg">
            </div>
          </div>
          <div class="twentytwenty-container twentytwenty-container-unifuse">
            <div class="cmpcontent">
              <img src="./images/slider/in-domain-jpg/depth1_unifuse.jpg">
            </div>
            <div class="cmpcontent">
              <img src="./images/slider/in-domain-jpg/depth1_unifuse_pseudo.jpg">
            </div>
          </div>
          <div class="twentytwenty-container twentytwenty-container-unifuse">
            <div class="cmpcontent">
              <img src="./images/slider/in-domain-jpg/error1_unifuse.jpg">
            </div>
            <div class="cmpcontent">
              <img src="./images/slider/in-domain-jpg/error1_unifuse_pseudo.jpg">
            </div>
          </div>
        </div>

        <div class="twoitem">
          <div class="twentytwenty-container twentytwenty-container-top">
            <div class="cmpcontent">
              <img src="./images/slider/in-domain-jpg/rgb2.jpg">
            </div>
            <div class="cmpcontent">
              <img src="./images/slider/in-domain-jpg/gt2.jpg">
            </div>
          </div>
          <div class="twentytwenty-container twentytwenty-container-unifuse">
            <div class="cmpcontent">
              <img src="./images/slider/in-domain-jpg/depth2_unifuse.jpg">
            </div>
            <div class="cmpcontent">
              <img src="./images/slider/in-domain-jpg/depth2_unifuse_pseudo.jpg">
            </div>
          </div>
          <div class="twentytwenty-container twentytwenty-container-unifuse">
            <div class="cmpcontent">
              <img src="./images/slider/in-domain-jpg/error2_unifuse.jpg">
            </div>
            <div class="cmpcontent">
              <img src="./images/slider/in-domain-jpg/error2_unifuse_pseudo.jpg">
            </div>
          </div>
        </div>
        <!-- BiFuse++ -->
        <div class="twoitem">
            <div class="twentytwenty-container twentytwenty-container-top">
              <div class="cmpcontent">
                <img src="./images/slider/in-domain-jpg/rgb3.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/in-domain-jpg/gt3.jpg">
              </div>
            </div>
            <div class="twentytwenty-container twentytwenty-container-bifusev2">
              <div class="cmpcontent">
                <img src="./images/slider/in-domain-jpg/depth3_bifusev2.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/in-domain-jpg/depth3_bifusev2_pseudo.jpg">
              </div>
            </div>
            <div class="twentytwenty-container twentytwenty-container-bifusev2">
              <div class="cmpcontent">
                <img src="./images/slider/in-domain-jpg/error3_bifusev2.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/in-domain-jpg/error3_bifusev2_pseudo.jpg">
              </div>
            </div>
          </div>

          <div class="twoitem">
            <div class="twentytwenty-container twentytwenty-container-top">
              <div class="cmpcontent">
                <img src="./images/slider/in-domain-jpg/rgb4.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/in-domain-jpg/gt4.jpg">
              </div>
            </div>
            <div class="twentytwenty-container twentytwenty-container-bifusev2">
              <div class="cmpcontent">
                <img src="./images/slider/in-domain-jpg/depth4_bifusev2.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/in-domain-jpg/depth4_bifusev2_pseudo.jpg">
              </div>
            </div>
            <div class="twentytwenty-container twentytwenty-container-bifusev2">
              <div class="cmpcontent">
                <img src="./images/slider/in-domain-jpg/error4_bifusev2.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/in-domain-jpg/error4_bifusev2_pseudo.jpg">
              </div>
            </div>
          </div>

      </div>
    </div>
  </div>
</section>
<!-- point cloud -->
<div class="wrapper">
    <div class="image-container">
        <img id="rgbImage1" src="pcd/1372_rgb.jpg" alt="RGB Image 1">
    </div>
    <div id="container1372" class="pcd_container">
        <div id="controls1372" class="controls">
            <label for="scale1">Scale:</label>
            <input type="range" id="scale1" name="scale" min="0.1" max="10" step="0.1" value="1">
            <label for="posX1">Position X:</label>
            <input type="range" id="posX1" name="posX" min="-10" max="10" step="0.1" value="0">
            <label for="posY1">Position Y:</label>
            <input type="range" id="posY1" name="posY" min="-10" max="10" step="0.1" value="0">
            <label for="posZ1">Position Z:</label>
            <input type="range" id="posZ1" name="posZ" min="-10" max="10" step="0.1" value="0">
            <label for="pointSize1">Point Size:</label>
            <input type="range" id="pointSize1" name="pointSize" min="0.001" max="0.1" step="0.001" value="0.001">
        </div>
    </div>
</div>

<!-- BiFuse++ -->
<div class="wrapper">
    <div class="image-container">
        <img id="rgbImage1" src="pcd/bifuse/1169_rgb.jpg" alt="RGB Image 1">
    </div>
    <div id="container1169" class="pcd_container">
        <div id="controls1169" class="controls">
            <label for="scale1">Scale:</label>
            <input type="range" id="scale1" name="scale" min="0.1" max="10" step="0.1" value="1">
            <label for="posX1">Position X:</label>
            <input type="range" id="posX1" name="posX" min="-10" max="10" step="0.1" value="0">
            <label for="posY1">Position Y:</label>
            <input type="range" id="posY1" name="posY" min="-10" max="10" step="0.1" value="0">
            <label for="posZ1">Position Z:</label>
            <input type="range" id="posZ1" name="posZ" min="-10" max="10" step="0.1" value="0">
            <label for="pointSize1">Point Size:</label>
            <input type="range" id="pointSize1" name="pointSize" min="0.001" max="0.1" step="0.001" value="0.001">
        </div>
    </div>
</div>
<!-- point cloud -->

<section class="section pt-0 pb-4">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Zero-shot Gallery</h2>
          <p>This is the zero-shot qualitative improvements with backbone models (UniFuse and Bifuse++ are selected) trained on the entire Matterport3D dataset and test on Stanford2D3D test set.
            <br><strong>+Ours</strong> indicates using the pseudo ground truth training pipeline proposed in our methods.</p>
        </div>
      </div>
    </div>
</section>

<section class="hero is-light is-small mt-4">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel-horizontal" class="carousel results-carousel">

        <!-- UniFuse -->
        <div class="twoitem">
            <div class="twentytwenty-container twentytwenty-container-top">
              <div class="cmpcontent">
                <img src="./images/slider/zero-shot-jpg/rgb1.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/zero-shot-jpg/gt1.jpg">
              </div>
            </div>
            <div class="twentytwenty-container twentytwenty-container-unifuse">
              <div class="cmpcontent">
                <img src="./images/slider/zero-shot-jpg/depth1_unifuse.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/zero-shot-jpg/depth1_unifuse_pseudo.jpg">
              </div>
            </div>
            <div class="twentytwenty-container twentytwenty-container-unifuse">
              <div class="cmpcontent">
                <img src="./images/slider/zero-shot-jpg/error1_unifuse.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/zero-shot-jpg/error1_unifuse_pseudo.jpg">
              </div>
            </div>
          </div>
  
          <div class="twoitem">
            <div class="twentytwenty-container twentytwenty-container-top">
              <div class="cmpcontent">
                <img src="./images/slider/zero-shot-jpg/rgb2.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/zero-shot-jpg/gt2.jpg">
              </div>
            </div>
            <div class="twentytwenty-container twentytwenty-container-unifuse">
              <div class="cmpcontent">
                <img src="./images/slider/zero-shot-jpg/depth2_unifuse.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/zero-shot-jpg/depth2_unifuse_pseudo.jpg">
              </div>
            </div>
            <div class="twentytwenty-container twentytwenty-container-unifuse">
              <div class="cmpcontent">
                <img src="./images/slider/zero-shot-jpg/error2_unifuse.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/zero-shot-jpg/error2_unifuse_pseudo.jpg">
              </div>
            </div>
          </div>
          <!-- BiFuse++ -->
          <div class="twoitem">
              <div class="twentytwenty-container twentytwenty-container-top">
                <div class="cmpcontent">
                  <img src="./images/slider/zero-shot-jpg/rgb3.jpg">
                </div>
                <div class="cmpcontent">
                  <img src="./images/slider/zero-shot-jpg/gt3.jpg">
                </div>
              </div>
              <div class="twentytwenty-container twentytwenty-container-bifusev2">
                <div class="cmpcontent">
                  <img src="./images/slider/zero-shot-jpg/depth3_bifusev2.jpg">
                </div>
                <div class="cmpcontent">
                  <img src="./images/slider/zero-shot-jpg/depth3_bifusev2_pseudo.jpg">
                </div>
              </div>
              <div class="twentytwenty-container twentytwenty-container-bifusev2">
                <div class="cmpcontent">
                  <img src="./images/slider/zero-shot-jpg/error3_bifusev2.jpg">
                </div>
                <div class="cmpcontent">
                  <img src="./images/slider/zero-shot-jpg/error3_bifusev2_pseudo.jpg">
                </div>
              </div>
            </div>
  
            <div class="twoitem">
              <div class="twentytwenty-container twentytwenty-container-top">
                <div class="cmpcontent">
                  <img src="./images/slider/zero-shot-jpg/rgb4.jpg">
                </div>
                <div class="cmpcontent">
                  <img src="./images/slider/zero-shot-jpg/gt4.jpg">
                </div>
              </div>
              <div class="twentytwenty-container twentytwenty-container-bifusev2">
                <div class="cmpcontent">
                  <img src="./images/slider/zero-shot-jpg/depth4_bifusev2.jpg">
                </div>
                <div class="cmpcontent">
                  <img src="./images/slider/zero-shot-jpg/depth4_bifusev2_pseudo.jpg">
                </div>
              </div>
              <div class="twentytwenty-container twentytwenty-container-bifusev2">
                <div class="cmpcontent">
                  <img src="./images/slider/zero-shot-jpg/error4_bifusev2.jpg">
                </div>
                <div class="cmpcontent">
                  <img src="./images/slider/zero-shot-jpg/error4_bifusev2_pseudo.jpg">
                </div>
              </div>
            </div>

      </div>
    </div>
  </div>
</section>

<section class="section pt-0 pb-4">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">In-the-wild Gallery</h2>
          <p>We showcase zero-shot qualitative results using a combination of images captured by us and randomly sourced from the internet
            <span class="footnote" 
            title="Stig Nygaard, https://www.flickr.com/photos/stignygaard/49659694937, CC BY 2.0 DEED 
            &#10;Dominic Alves, https://www.flickr.com/photos/dominicspics/28296671029/, CC BY 2.0 DEED 
            &#10;Luca Biada, https://www.flickr.com/photos/pedroscreamerovsky/6873256488/, CC BY 2.0 DEED 
            &#10;Luca Biada, https://www.flickr.com/photos/pedroscreamerovsky/6798474782/, CC BY 2.0 DEED">[1]</span>
            to assess the model’s generalization ability. 
            For privacy reasons, we have obscured the camera-man in the images.</p>
        </div>
      </div>
    </div>
</section>

<section class="hero is-light is-small mt-4">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel-horizontal" class="carousel results-carousel">

        <!-- UniFuse -->
        <div class="twoitem">
            <div class="twentytwenty-container twentytwenty-container-in-the-wild">
              <div class="cmpcontent">
                <img src="./images/slider/in-the-wild-jpg/rgb1.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/in-the-wild-jpg/depth1_unifuse_pseudo.jpg">
              </div>
            </div>
            <div class="twentytwenty-container twentytwenty-container-unifuse">
              <div class="cmpcontent">
                <img src="./images/slider/in-the-wild-jpg/depth1_unifuse.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/in-the-wild-jpg/depth1_unifuse_pseudo.jpg">
              </div>
            </div>
          </div>
  
          <div class="twoitem">
            <div class="twentytwenty-container twentytwenty-container-in-the-wild">
              <div class="cmpcontent">
                <img src="./images/slider/in-the-wild-jpg/rgb2.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/in-the-wild-jpg/depth2_unifuse_pseudo.jpg">
              </div>
            </div>
            <div class="twentytwenty-container twentytwenty-container-unifuse">
              <div class="cmpcontent">
                <img src="./images/slider/in-the-wild-jpg/depth2_unifuse.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/in-the-wild-jpg/depth2_unifuse_pseudo.jpg">
              </div>
            </div>
          </div>

          <div class="twoitem">
            <div class="twentytwenty-container twentytwenty-container-in-the-wild">
              <div class="cmpcontent">
                <img src="./images/slider/in-the-wild-jpg/rgb3.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/in-the-wild-jpg/depth3_unifuse_pseudo.jpg">
              </div>
            </div>
            <div class="twentytwenty-container twentytwenty-container-unifuse">
              <div class="cmpcontent">
                <img src="./images/slider/in-the-wild-jpg/depth3_unifuse.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/in-the-wild-jpg/depth3_unifuse_pseudo.jpg">
              </div>
            </div>
          </div>

          <div class="twoitem">
            <div class="twentytwenty-container twentytwenty-container-in-the-wild">
              <div class="cmpcontent">
                <img src="./images/slider/in-the-wild-jpg/rgb4.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/in-the-wild-jpg/depth4_unifuse_pseudo.jpg">
              </div>
            </div>
            <div class="twentytwenty-container twentytwenty-container-unifuse">
              <div class="cmpcontent">
                <img src="./images/slider/in-the-wild-jpg/depth4_unifuse.jpg">
              </div>
              <div class="cmpcontent">
                <img src="./images/slider/in-the-wild-jpg/depth4_unifuse_pseudo.jpg">
              </div>
            </div>
          </div>
          
      </div>
    </div>
  </div>
</section>

<div class="wrapper">
    <div class="image-container">
        <img id="rgbImage1" src="pcd/Luca_Biada_flickr_2.jpeg" alt="RGB Image 1">
    </div>
    <div id="container1" class="pcd_container">
        <div id="controls1" class="controls">
            <label for="scale1">Scale:</label>
            <input type="range" id="scale1" name="scale" min="0.1" max="10" step="0.1" value="1">
            <label for="posX1">Position X:</label>
            <input type="range" id="posX1" name="posX" min="-10" max="10" step="0.1" value="0">
            <label for="posY1">Position Y:</label>
            <input type="range" id="posY1" name="posY" min="-10" max="10" step="0.1" value="0">
            <label for="posZ1">Position Z:</label>
            <input type="range" id="posZ1" name="posZ" min="-10" max="10" step="0.1" value="0">
            <label for="pointSize1">Point Size:</label>
            <input type="range" id="pointSize1" name="pointSize" min="0.001" max="0.1" step="0.001" value="0.05">
        </div>
    </div>
</div>
<br>
<div class="wrapper">
    <div class="image-container">
        <img id="rgbImage2" src="pcd/Luca_Biada_flickr_trainstation.jpeg" alt="RGB Image 2">
    </div>
    <div id="container2" class="pcd_container">
        <div id="controls2" class="controls">
            <label for="scale2">Scale:</label>
            <input type="range" id="scale2" name="scale" min="0.1" max="10" step="0.1" value="1">
            <label for="posX2">Position X:</label>
            <input type="range" id="posX2" name="posX" min="-10" max="10" step="0.1" value="0">
            <label for="posY2">Position Y:</label>
            <input type="range" id="posY2" name="posY" min="-10" max="10" step="0.1" value="0">
            <label for="posZ2">Position Z:</label>
            <input type="range" id="posZ2" name="posZ" min="-10" max="10" step="0.1" value="0">
            <label for="pointSize2">Point Size:</label>
            <input type="range" id="pointSize2" name="pointSize" min="0.001" max="0.1" step="0.001" value="0.05">
        </div>
    </div>
</div>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Method. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">How it works</h2>
        <div class="content has-text-justified">
          <h3 class="title has-text-centered">
            Model Pipeline
          </h3>

          <p>
            Our proposed training pipeline involves joint training on both labeled 360 data with ground truth and unlabeled 360 data. 
            (a) For labeled data, we train our 360 depth model with the loss between depth prediction and ground truth. 
            (b) For unlabeled data, we propose to distill knowledge from a pre-trained perspective-view monocular depth estimator. 
            In this paper, we use Depth Anything to generate pseudo ground truth for training. 
            However, more advanced techniques could be applied. 
            These perspective-view monocular depth estimators fail to produce reasonable equirectangular depth as there exists a domain gap. 
            Therefore, we distill knowledge by inferring six perspective cube faces and passing them through perspective-view monocular depth estimators. 
            To ensure stable and effective training, 
            we propose generating a valid pixel mask with Segment Anything while calculating loss. 
            (c) Furthermore, we augment random rotation on RGB before passing it into Depth Anything, 
            as well as on predictions from the 360 depth model.
          </p>

          <img id="method_inference" width="100%" src="./images/pipeline/pipeline_v4.jpg" alt="Depth Anywhere training pipeline"/>

          <h3 class="title has-text-centered">
            Valid Pixel Masking
          </h3>

          <p>
            We used Grounded-Segment-Anything to mask out invalid pixels based on two text prompts: “sky” and “watermark.” 
            These regions lack depth sensor ground truth labels in all previous datasets. 
            Unlike Depth Anything, which sets sky regions as 0 disparity, we follow ground truth training to ignore these regions during training for two reasons: 
            (1) segmentation may misclassify and set other regions as zero, leading to noisy labeling, and 
            (2) watermarks are post-processing regions that lack geometrical meaning.
          </p>

          <img id="method_inference" width="100%" src="./images/valid_mask/valid_mask_v2.jpg" alt="Depth Anywhere training pipeline"/>

          <h3 class="title has-text-centered">
            Random Rotation Processing
          </h3>

          <p>
            As shown in the center row of the figure, 
            an undesired cube artifact appears when we apply joint training with pseudo ground truth from Depth Anything directly. 
            This issue arises from independent relative distances within each cube face caused by a static point of view. 
            Ignoring cross-cube relationships results in poor knowledge distillation. 
            To address this, as shown in (c) in the model pipeline, 
            we randomly rotate the RGB image before inputting it into Depth Anything. 
            This enables better distillation of depth information from varying perspectives within the equirectangular image.
          </p>

          <img id="method_inference" width="100%" src="./images/cube_patent/cube_artifact.jpg" alt="Depth Anywhere training pipeline"/>

          <p class="mt-5">
            Refer to the pdf paper linked above for more details on qualitative, quantitative, and ablation studies.
          </p>
        </div>
      </div>
    </div>
    <!--/ Method. -->
  </div>
</section>


<script>
    $(window).on('load', function() {
      bulmaCarousel.attach('#results-carousel-horizontal', {
        slidesToScroll: 1,
        slidesToShow: 3,
        loop: true,
        autoplay: true,
      });
  
      bulmaCarousel.attach('#results-carousel-vertical', {
        slidesToScroll: 1,
        slidesToShow: 5,
        loop: true,
        autoplay: true,
      });
  
      bulmaCarousel.attach('#results-carousel-testimonials', {
        slidesToScroll: 1,
        slidesToShow: 3,
        loop: true,
        autoplay: true,
        breakpoints: [
          {
            changePoint: 50 + 260 * 2,
            slidesToShow: 1,
            slidesToScroll: 1,
            loop: true,
            autoplay: true,
          },
          {
            changePoint: 50 + 260 * 3,
            slidesToShow: 2,
            slidesToScroll: 1,
            loop: true,
            autoplay: true,
          },
          {
            changePoint: 50 + 260 * 4,
            slidesToShow: 3,
            slidesToScroll: 1,
            loop: true,
            autoplay: true,
          }
        ],
      });
  
      $(".twentytwenty-container-top").twentytwenty({
        before_label: 'Input',
        after_label: 'GT',
        default_offset_pct: 0.75,
      });

      $(".twentytwenty-container-in-the-wild").twentytwenty({
        before_label: 'Input',
        after_label: 'UniFuse + Ours',
        default_offset_pct: 0.75,
      });

      $(".twentytwenty-container-unifuse").twentytwenty({
        before_label: 'UniFuse',
        after_label: 'UniFuse + Ours',
        default_offset_pct: 0.5,
      });

      $(".twentytwenty-container-bifusev2").twentytwenty({
        before_label: 'BiFuse++',
        after_label: 'BiFuse++ + Ours',
        default_offset_pct: 0.5,
      });
  
      $('.results-carousel').css({
        'max-height': '2000px',
        'visibility': 'visible'
      });
    });
  </script>

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">Citation</h2>
    <pre class="selectable"><code>@article{wang2024depthanywhere,
        title={Depth Anywhere: Enhancing 360 Monocular Depth Estimation via Perspective Distillation and Unlabeled Data Augmentation},
        author={Ning-Hsu Wang and Yu-Lun Liu},
        journal={arXiv},
        year={2024}
    }</code></pre>
  </div>
</section>

<footer class="footer pt-4 pb-0">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            Website template based on
            <a href="https://github.com/nerfies/nerfies.github.io">
              Nerfies
            </a>
            and licensed under
            <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
              CC-BY-SA-4.0
            </a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
